name: compile
on: [push]
jobs:
  compile:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository.
      uses: actions/checkout@v2
    - name: Setup Tectonic.
      uses: wtfjoke/setup-tectonic@v1
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
    - name: Run Tectonic
      run: |
        tectonic -X compile whyjulia.tex -Z shell-escape
        git add .
        git config --global user.email "tectonicbot@example.com"
        git config --global user.name "tectonicbot"
        git commit -m "Uploading PDF." || true
    - name: Push the changes.
      uses: ad-m/github-push-action@master
      with:
        branch: ${{ github.ref }}
        github_token: ${{ secrets.GITHUB_TOKEN }}
